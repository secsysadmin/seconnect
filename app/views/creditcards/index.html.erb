<div class='page-wrapper'>
  

  <div class='banner'>
    <h1>Creditcards</h1>
  </div>
  <p id="notice"><%= notice %></p>

  <% if User.find(session[:user_id]).permission_type == 'admin' %>
    <div class='card-stack'>
      <%= link_to 'Completed Credit Card Requests', creditcard_approved_path, {:class => 'button'} %>
      <%= link_to 'Pending Credit Card Requests', creditcard_inprogress_path, {:class => 'button'} %>
    </div>
  <% end %>
  
  <div class='card-stack'>
    <div class='card'>
      <table>
        <thead>
          <tr class='strongRow'>
            <th>Request Submitted By</th>
            <th>Vendor</th>
            <th>Amount</th>
            <th>Payment link</th>
            <th>Contact name</th>
            <th>Phone</th>
            <th>Confirmation order</th>
            <th>Reservation name</th>
            <th>Reservation phone number</th>
            <th>Status</th>
            <th>Travel Password</th>
            <th>Statement of Purpose</th>
            <th colspan="5"></th>
          </tr>
        </thead>

        <tbody>
        <% if User.find(session[:user_id]).permission_type == 'user' %>
          <% @creditcards = @creditcards.where('user_id = ?', User.find(session[:user_id]).id) %>
        <% end %>
          <% @creditcards.each do |creditcard| %>
            <tr class='normalRow'>
              <td><%= User.find_by(id: creditcard.user_id).first_name %></td>
              <td><%= Vendor.where(id: creditcard.vendor_id).last.vendor_name%></td>
              <td><%= creditcard.amount %></td>
              <td><%= creditcard.contact_name %></td>
              <td><%= creditcard.payment_link %></td>
              <td><%= creditcard.phone %></td>
              <td><%= creditcard.Confirmation_order %></td>
              <td><%= creditcard.reservation_name %></td>
              <td><%= creditcard.res_ph %></td>
              <td><%= creditcard.travel_password_cc%></td>
              <td><%= creditcard.status %></td>
              <td><%= creditcard.sop %></td>
              <td><%= creditcard.notes %></td>
              <td class='noSpace'><%= link_to 'Show', creditcard, {:class => 'crudButton'} %></td>
              <td class='noSpace'><%= link_to 'Edit', edit_creditcard_path(creditcard), {:class => 'crudButton'} %></td>
              <td class='noSpace'><%= button_to 'Delete', creditcard, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <div class='card-stack'>
    <%= link_to 'New Creditcard', new_creditcard_path, {:class => 'button'}%>
    <%= link_to 'Back', financial_forms_path, {:class => 'button'} %>
  </div>
</div>
